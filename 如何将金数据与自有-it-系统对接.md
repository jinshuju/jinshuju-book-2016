# 如何与自有 IT 系统对接

当一款产品需要与其他产品集成时，往往意味着漫长的对接流程，从零开始了解对方的系统架构、低效的沟通，开发 API 等等，其中耗费的时间与精力，拖慢了很多公司的工作效率。

金数据目前已经拥有完整的 API，可以让你免去很多对接工作，也有附带参数跳转的功能，方便你将数据写入自己的系统内。

## 开启 API

金数据 API 为具备编程能力的用户提供了极强的扩展功能。开发者可以通过表单API获取表单定义、通过数据 API 追加数据或通过数据推送 API 将新提交的数据推送到自己的平台。

前往「个人中心」——「API」 来开启你的API支持及获取 API Key／Secret.

## API 访问规则

* 所有的数据格式为 JSON
* 所有的数据传输编码为 UTF-8
* 目前，API 访问的地址来源为 `https://jinshuju.net/api/v1/`
* 除了数据推送 API 外，所有的 API 都需要恰当的 API 访问权限。目前我们仅支持 HTTP Basic 验证的方式。

## 目前提供的 API

1. 数据推送 API：开启数据推送 API 的表单收到新数据时，金数据会将该数据通过 HTTP POST 推送到指定的 URL。

2. 表单 API：你可以通过该 API 获取表单定义，然后你可以在任意你熟知的平台上重绘这个表单。通过结合数据 API，你可以脱离金数据界面绘制和添加数据。

3. 数据 API：你可以通过这个 API 添加数据。你能够将所有的数据通过 JSON 格式以 HTTP POST 的方式发送到对应的表单。


## 设置跳转的附带参数

你可以设置填表者点击提交后，附带当前表单的部分内容跳转到指定网址。

目前可供选择的附带参数包括表单中的「单行／多行文字」、「单项／多项选择」、「数字」、「邮箱」、「电话」、「日期」以及「网址」等字段。如果表单中包含商品字段，则还可以附带序号和总价。你最多可以选择 3 个附带参数，如图 1 所示。

![](/assets/图1 选择附加参数.png)

<center>图1 选择附加参数</center>

在表单的「设置」——「数据提交」页面的 「填写者填写完表单后」 选择「自动打开其他网页」，填写你要跳转的网址，并勾选需要附加的参数。

当用户填写了该表单并提交后，将会附带勾选的参数跳转到网页。例如：`http://success.test.com/?field_1=xxx&field_2=xxx&jamr_h=xxx&serial_number=xxx`

跳转的网址包含 4 个参数：`serial_number`、`field_1`、`field_2`和`jamr_h`。 前 3 个是你勾选的字段，字段的 API Code 可以点击上图所示的「字段对照表」查看得到。jamr\_h是系统自动生成的验证码。您可以通过发送一个 GET 请求至`https://jinshuju.net/api/v1/jamr_v` 来验证跳转参数的有效性。

### 验证跳转参数的有效性

你可以对跳转附带的参数进行验证，以保证该参数有效或者没有被恶意篡改。

你需要在提交成功转向后的 **10 分钟内**发送 GET 请求至 `https://jinshuju.net/api/v1/jamr_v`进行验证

例如： `https://jinshuju.net/api/v1/jamr_v?field_1=xxx&field_2=xxx&jamr_h=xxx&serial_number=xxx`

如果返回 200 则表示验证通过，如果返回 400 则表示验证失败，失败信息可以查看 response JSON 中的 message。

